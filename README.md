## 完美校园打卡脚本

一个基于adb模拟点击等各种调试功能的打卡脚本。打卡一条龙。

## 打卡要求
疫情期间，学生要求在两个地方打卡。一个是完美校园，另一个是省教育的页面。

完美校园打卡是在支付宝的小程序里打卡，打卡时需要开启定位，否则无效。  

打卡成功截图通过QQ群作业提交。  

省教育的打卡则是在一个页面中打卡。

## 准备工作
0. 需要原料
=======
* 一台USB接口没坏且安装了python电脑  
* 一台支持通过usb调试且工作良好的手机  
* 一个人  

该项目在以下环境测试通过，供参考：  
* Mi9 SE MIUI11 Android 10  
* Windows 10 1909  
* python 3.7  

1. 安装ADB
=======
ADB是 Android 手机的应用开发调试工具，供开发者使用，因此具备很多高级功能。  
这些高级功能单纯靠手机单方面是很难实现的。  
因此需要先在电脑上安装。  
首先是下载android SDK：https://developer.android.google.cn/studio/releases/platform-tools  
下载完成后得到一个zip包  
这里以windows为例  
将其解压，并打开里面的platform-tools文件夹。  
可以看到adb.exe就在其中。  
点击资源管理器搜索框的左边那个框，复制路径。  
点击桌面上的此电脑，右键属性 - 左边侧边栏高级系统设置 - 高级选项卡 - 环境变量... - * 系统变量 * 中找到Path双击
如果打开的是一个长长的列表点击右边的添加，把刚刚复制的路径添加到其中。  
如果打开的是一个只有两个文本框的对话框。在第二个文本框末尾添加分号再粘贴刚刚复制的路径。
然后确定确定确定。

此时按下Win键 + X 键 再按下 i 键， 打开powershell。输入adb回车，你应该得到很多英文帮助。  
但如果是找不到之类的提示，说明上面的添加路径到Path没有成功。要重试。

2. 测试adb是否正常工作
=====================
请百度如何在你的手机上开启usb调试模式。  
小米手机还需要打开允许模拟点击的选项。  

之后使用先前提及到的adb命令。  
adb devices 可以查看是否连接上了你的设备。
测试命令，要确保以下命令都正常工作：  
adb shell input tap X Y
将X Y 替换成手机上的一个坐标，看看它是否会点击手机上的那个地方。  
你可以在手机设置中的开发者模式打开显示触摸位置的叠加层查看坐标。  

检查是否成功启用定位：  
adb shell settings put secure location_mode 3  

检查是否成功截图到你的相册：  
adb shell screencap -p /sdcard/DCIM/camera/666.png  

检查是否成功返回主屏幕：
adb shell input keyevent HOME  

检查能否打开QQ: adb shell am start -n com.tencent.mobileqq/.activity.SplashActivity  

其他在程序中出现的ADB命令类型...

3. 安装python
============
在python.org 下载python3.7  
安装时要勾选添加到python路径选项。即安装完毕重启powershell后输入python -V (这个v是大写的)回车可以看到版本信息。  

4. 在手机段上的准备。
===================
确保将完美校园小程序添加到home界面。还有省教育系统的页面也通过浏览器添加到home界面。  
这样可以一点击图标就进入系统。  

5. 配置程序
==========
将personalInfo-sample.py重命名为personalInfo.py。  
并修改里边的信息，手机号，身份证号，群号等。  
打开开发者模式的触摸叠加（就顶上会显示你点击的坐标）。  
对照程序逻辑，修改click函数的坐标以及滑动的坐标。  
这是因为每个设备的点击位置是不一样的。

## 运行程序
==========
一切就绪以后，你就可以运行程序。  
程序将自动打开并截图，打开作业界面。